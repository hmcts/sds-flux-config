apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: pip-subscription-management
  namespace: pip
spec:
  releaseName: pip-subscription-management
  values:
    java:
      ingressHost: pip-subscription-management.staging.platform.hmcts.net
      environment:
        DATA_MANAGEMENT_URL: https://pip-data-management.staging.platform.hmcts.net
        ACCOUNT_MANAGEMENT_URL: https://pip-account-management.staging.platform.hmcts.net
        ENABLE_TESTING_SUPPORT_API: true
      keyVaults:
        pip-ss-kv:
          excludeEnvironmentSuffix: false
          resourceGroup: pip-ss-stg-rg
          secrets:
            - name: subscription-management-POSTGRES-FLEXIBLE-DATABASE
              alias: DB_NAME
            - name: subscription-management-POSTGRES-FLEXIBLE-PASS
              alias: DB_PASS
            - name: subscription-management-POSTGRES-FLEXIBLE-PORT
              alias: DB_PORT
            - name: subscription-management-POSTGRES-FLEXIBLE-USER
              alias: DB_USER
            - name: subscription-management-POSTGRES-FLEXIBLE-HOST
              alias: DB_HOST
            - name: app-pip-subscription-management-id
              alias: CLIENT_ID
            - name: app-pip-subscription-management-pwd
              alias: CLIENT_SECRET
            - name: app-tenant-id
              alias: TENANT_ID
            - name: app-pip-subscription-management-scope
              alias: APP_URI
            - name: app-pip-data-management-scope
              alias: DATA_MANAGEMENT_AZ_API
            - name: app-pip-account-management-scope
              alias: ACCOUNT_MANAGEMENT_AZ_API
            - name: app-pip-channel-management-scope
              alias: CHANNEL_MANAGEMENT_AZ_API
            - name: app-pip-publication-services-scope
              alias: PUBLICATION_SERVICES_AZ_API
            - name: app-insights-java-connection-string
              alias: APP_INSIGHTS_CONNECTION_STRING