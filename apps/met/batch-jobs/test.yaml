apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
  name: libragob-batch-housekeeping
  namespace: met
spec:
  releaseName: libragob-batch-housekeeping
  values:
    kind: CronJob
    image: hmctspublic.azurecr.io/libragob/housekeeping:prod-04c7ef66-1710266881 #{"$imagepolicy": "flux-system:libragob-batch-housekeeping"}
    schedule: "40 18 12 3 *"
    suspend: false
    keyVaults:
      libragob-test-kv:
        excludeEnvironmentSuffix: true
        secrets:
          - event-datasource-username
          - event-datasource-password
          - event-datasource-url
    environment:
      KV_NAME: libragob-test-kv
  chart:
    spec:
      chart: job
      sourceRef:
        kind: GitRepository
        name: chart-job
        namespace: flux-system
      interval: 1m
