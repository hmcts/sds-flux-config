---
apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: toffee-recipe-receiver
spec:
  chart:
    spec:
      chart: ./charts/recipe-receiver
      interval: 1m
      reconcileStrategy: ChartVersion
      sourceRef:
        kind: GitRepository
        name: recipe-receiver
        namespace: flux-system
      version: '*'
      valuesFiles:
        - values.yaml
  interval: 5m
  releaseName: toffee-recipe-receiver
  values:
    function:
      image: sdshmctspublic.azurecr.io/toffee/recipe-receiver:prod-1100a0e-20220609130124
      triggers:
        - type: azure-servicebus
          namespace: toffee-servicebus-${ENVIRONMENT}
          queueName: recipes
          queueLength: "5"
  environment:
    FULLY_QUALIFIED_NAMESPACE: "toffee-servicebus-${ENVIRONMENT}.servicebus.windows.net"
