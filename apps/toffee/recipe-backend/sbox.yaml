apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: toffee-recipe-backend
  namespace: toffee
spec:
  values:
    java:
      image: sdshmctspublic.azurecr.io/toffee/recipe-backend:prod-406686c-20230426114730 #{"$imagepolicy": "flux-system:toffee-recipe-backend"}
      ingressHost: toffee-recipe-backend.sandbox.platform.hmcts.net
      keyVaults:
        "toffeesi":
          secrets:
            - name: recipe-backend-POSTGRES-HOST-v14
              alias: POSTGRES_HOST
            - name: recipe-backend-POSTGRES-USER-v14
              alias: POSTGRES_USER
            - name: recipe-backend-POSTGRES-PASS-v14
              alias: POSTGRES_PASSWORD
    global:
      environment: sandbox
