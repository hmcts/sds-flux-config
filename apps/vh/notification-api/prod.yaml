apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: vh-notification-api
  namespace: vh
spec:
  releaseName: vh-notification-api
  values:
    java:
      ingressHost: vh-notification-api.platform.hmcts.net
    image: sdshmctspublic.azurecr.io/vh/notification-api:staging-202207071253-1 #{"$imagepolicy": "flux-system:vh-notification-api"}
    environment: "prod"
    resourceGroup: "vh-infra-core-prod"
    subscriptionId: "5ca62022-6aa2-4cee-aaa7-e7536c8d566c"
    tenantId: "531ff96d-0ae9-462a-8d2d-bec7c0b42082"
    managedIdentityClientId: "df0c1ced-b6cb-4fe0-a4e4-9bc48181435c"
  chart:
    spec:
      chart: ./stable/vh-notification-api/prod
  filterTags:
    extract: $ts
    pattern: '^prod-[a-f0-9]+-(?P<ts>[0-9]+)'
