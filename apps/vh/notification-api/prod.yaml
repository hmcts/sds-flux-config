apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: vh-notification-api
  namespace: vh
spec:
  releaseName: vh-notification-api
  values:
    java:
      ingressHost: vh-notification-api.platform.hmcts.net
      environment:
        SERVICES__NOTIFICATIONAPIRESOURCEID: http://vh-notification-api.platform.hmcts.net
        NotifyConfiguration__Environment: Prod
    image: sdshmctspublic.azurecr.io/vh/notification-api:staging-d8ab707-202207080930 #{"$imagepolicy": "flux-system:vh-notification-api"}
  chart:
    spec:
      chart: ./stable/vh-notification-api/prod
  filterTags:
    extract: $ts
    pattern: '^prod-[a-f0-9]+-(?P<ts>[0-9]+)'
