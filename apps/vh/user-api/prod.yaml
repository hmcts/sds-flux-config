apiVersion: helm.toolkit.fluxcd.io/v2beta1
kind: HelmRelease
metadata:
  name: vh-user-api
  namespace: vh
spec:
  releaseName: vh-user-api
  values:
    java:
      ingressHost: vh-user-api.platform.hmcts.net
    image: sdshmctspublic.azurecr.io/vh/user-api:staging-883314c-202207070246-090909 #{"$imagepolicy": "flux-system:vh-user-api"}
    environment: "prod"
    resourceGroup: "vh-infra-core-prod"
    subscriptionId: "5ca62022-6aa2-4cee-aaa7-e7536c8d566c"
    tenantId: "531ff96d-0ae9-462a-8d2d-bec7c0b42082"
    managedIdentityClientId: "df0c1ced-b6cb-4fe0-a4e4-9bc48181435c"
  chart:
    spec:
      chart: ./stable/vh-user-api/prod
  filterTags:
    extract: $ts
    pattern: '^prod-[a-f0-9]+-(?P<ts>[0-9]+)'
