apiVersion: helm.toolkit.fluxcd.io/v2beta2
kind: HelmRelease
metadata:
  name: darts-api-migration
  namespace: darts-modernisation
spec:
  releaseName: darts-api-migration
  values:
    java:
      ingressHost: darts-api-migration.platform.hmcts.net
      environment:
        ENABLE_FLYWAY: true
        RUN_DB_MIGRATION_ON_STARTUP: true
        DARTS_API_DB_HOST: "darts-migration-prod.postgres.database.azure.com"
        DARTS_API_DB_NAME: "darts-migration-prod"
        DARTS_GATEWAY_URL: https://darts-migration-gateway.platform.hmcts.net
        DARTS_PORTAL_URL: https://darts-migration.apps.hmcts.net
        DARTS_LOG_LEVEL: DEBUG
        RESTART_ME: '007'
    function:
      #pin the release version as per darts-api-migration.yaml
      image: sdshmctspublic.azurecr.io/darts/api:prod-ab41541-20240130140812