---
apiVersion: helm.fluxcd.io/v1
kind: HelmRelease
metadata:
  name: mailrelay
  namespace: mailrelay
spec:
  timeout: 1200
  values:
    image:
      repository: sdshmctspublic.azurecr.io/exim-relay
      tag: 0.1.11
      pullPolicy: IfNotPresent
    service:
      type: LoadBalancer
      loadBalancerIP: "10.145.31.31"
    global:
      environment: dev

    workload: StatefulSet
    
    fluentbit:
      enabled: true
      image:
        repository: sdshmctspublic.azurecr.io/fluent/fluent-bit
        tag: 1.7.2
        pullPolicy: IfNotPresent
    
    eximexporter:
      enabled: true
      image:
        repository: sdshmctspublic.azurecr.io/exim-exporter
        tag: 0.3
        pullPolicy: IfNotPresent
        ports:
          - name: eximexporter
            containerPort: 9636
    
    eximExporterService:
      type: ClusterIP 
      port: 9636

    volumeClaim:
      storageClass: "managed-premium"
      storageSize: 500Gi
    
    prometheus:
      enabled: true
